// ========================================
// å¤åˆ¶ä»¥ä¸‹ä»£ç åˆ°æ§åˆ¶å°æ‰§è¡Œ
// ========================================

(function() {
  const userInfo = wx.getStorageSync('userInfo') || { nickName: 'æµ‹è¯•ç”¨æˆ·', avatarUrl: '/assets/default-avatar.png' };
  const userId = wx.getStorageSync('userId') || 1001;
  let orders = wx.getStorageSync('pending_orders') || [];
  
  const now = new Date();
  const fmt = (d) => {
    const pad = (n) => String(n).padStart(2, '0');
    return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
  };
  
  // è®¢å•1ï¼šå·²è„±ç¨¿ï¼ˆè¶…æœŸ2å¤©ï¼‰
  const createTime1 = new Date(now.getTime() - 9*24*60*60*1000);
  const deadline1 = new Date(now.getTime() - 2*24*60*60*1000);
  
  orders.push({
    id: '2025' + Date.now().toString().slice(-9),
    productName: 'ã€å·²è„±ç¨¿ã€‘èµ›åšæœ‹å…‹å¤´åƒ',
    productImage: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==',
    price: 88,
    spec: 'å…¨èº«/ç«–å±',
    deliveryDays: 7,
    createTime: fmt(createTime1),
    deadline: fmt(deadline1),
    status: 'overdue',
    statusText: 'å·²æ‹–ç¨¿',
    buyerId: userId,
    buyerName: userInfo.nickName,
    buyerAvatar: userInfo.avatarUrl,
    artistId: userId,
    artistName: userInfo.nickName,
    artistAvatar: userInfo.avatarUrl,
    serviceName: 'å¾…åˆ†é…',
    serviceAvatar: '/assets/default-avatar.png'
  });
  
  // è®¢å•2ï¼šä¸´è¿‘æˆªç¨¿ï¼ˆ12å°æ—¶åï¼‰
  const createTime2 = new Date(now.getTime() - 6.5*24*60*60*1000);
  const deadline2 = new Date(now.getTime() + 0.5*24*60*60*1000);
  
  orders.push({
    id: '2025' + (Date.now()+1).toString().slice(-9),
    productName: 'ã€ä¸´è¿‘æˆªç¨¿ã€‘åŠ¨æ¼«æ’ç”»',
    productImage: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z8DwHwAFBQIAX8jx0gAAAABJRU5ErkJggg==',
    price: 168,
    spec: 'åŠèº«/æ¨ªå±',
    deliveryDays: 7,
    createTime: fmt(createTime2),
    deadline: fmt(deadline2),
    status: 'nearDeadline',
    statusText: 'ä¸´è¿‘æˆªç¨¿',
    buyerId: userId,
    buyerName: userInfo.nickName,
    buyerAvatar: userInfo.avatarUrl,
    artistId: userId,
    artistName: userInfo.nickName,
    artistAvatar: userInfo.avatarUrl,
    serviceName: 'å¾…åˆ†é…',
    serviceAvatar: '/assets/default-avatar.png'
  });
  
  wx.setStorageSync('pending_orders', orders);
  console.log('âœ… åˆ›å»ºæˆåŠŸï¼2ä¸ªæµ‹è¯•è®¢å•å·²æ·»åŠ ');
  console.log('è®¢å•1: å·²è„±ç¨¿2å¤© ğŸ”´');
  console.log('è®¢å•2: ä¸´è¿‘æˆªç¨¿(12å°æ—¶) ğŸŸ¡');
  wx.reLaunch({ url: '/pages/workspace/index' });
})();

