# ä¸¥æ ¼äº‘ç«¯æ¨¡å¼æ¸…ç†æŠ¥å‘Š

**ç”Ÿæˆæ—¶é—´**ï¼š2025-11-22  
**æ¨¡å¼çŠ¶æ€**ï¼šâœ… å·²å¯ç”¨  
**æ‹¦æˆªæ–¹æ³•**ï¼š6ä¸ªï¼ˆåŒæ­¥+å¼‚æ­¥ï¼‰

---

## âœ… ä¸¥æ ¼äº‘ç«¯æ¨¡å¼é…ç½®

### ğŸ“‹ ç™½åå•ï¼ˆå…è®¸çš„æœ¬åœ°ç¼“å­˜ï¼‰
```javascript
'logs',              // ç³»ç»Ÿæ—¥å¿—
'hasLoggedIn',       // ç™»å½•çŠ¶æ€æ ‡è®°
'isGuestMode',       // æ¸¸å®¢æ¨¡å¼æ ‡è®°
'userId',            // ç”¨æˆ·IDç¼“å­˜ï¼ˆä»äº‘ç«¯è·å–åç¼“å­˜ï¼‰
'openid',            // ç”¨æˆ·openidç¼“å­˜
'userInfo',          // ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ç¼“å­˜
'userRoles',         // ç”¨æˆ·è§’è‰²ç¼“å­˜
'avatar_migrated_v2', // å¤´åƒè¿ç§»æ ‡è®°
'userId_counter'     // userIdè®¡æ•°å™¨
```

### âŒ é»‘åå•ï¼ˆç¦æ­¢çš„æœ¬åœ°ç¼“å­˜ï¼‰
```javascript
/^pending_orders$/,       // å¾…å¤„ç†è®¢å•
/^completed_orders$/,     // å·²å®Œæˆè®¢å•
/^orders$/,               // æ‰€æœ‰è®¢å•
/^mock_orders$/,          // Mockè®¢å•
/^service_list$/,         // å®¢æœåˆ—è¡¨
/^customer_service_list$/, // å®¢æˆ·æœåŠ¡åˆ—è¡¨
/^artist_applications$/,  // ç”»å¸ˆç”³è¯·
/^product_categories$/,   // å•†å“åˆ†ç±»
/^mock_products$/,        // Mockå•†å“
/^products$/,             // å•†å“åˆ—è¡¨
/^guest_orders$/,         // æ¸¸å®¢è®¢å•
/^withdraw_records$/,     // æç°è®°å½•
/^reward_records$/,       // æ‰“èµè®°å½•
/^income_ledger$/,        // æ”¶å…¥å°è´¦
/.*_draft$/,              // æ‰€æœ‰è‰ç¨¿
/.*_cache$/,              // æ‰€æœ‰ç¼“å­˜
/.*_temp$/                // æ‰€æœ‰ä¸´æ—¶æ•°æ®
```

---

## ğŸ“Š æ¸…ç†è¿›åº¦

| çŠ¶æ€ | æ•°é‡ | è¯´æ˜ |
|------|------|------|
| âœ… å·²æ¸…ç† | 11 | æ”¹ä¸ºäº‘ç«¯APIè°ƒç”¨ |
| âš ï¸ å‰©ä½™ | 24 | éœ€è¦è¿›ä¸€æ­¥è¯„ä¼° |

---

## âœ… å·²æ¸…ç†æ–‡ä»¶ï¼ˆç¬¬ä¸€æ‰¹ï¼‰

### 1. utils/order-helper.js
- **normalizeOrders**: `products` æ”¹ä¸ºä»å‚æ•°ä¼ å…¥
- **getAllOrders**: æ ‡è®°ä¸ºåºŸå¼ƒï¼Œè¿”å›ç©ºæ•°ç»„
- **prepareOrdersForPage**: `orders` æ”¹ä¸ºä»å‚æ•°ä¼ å…¥

### 2. utils/system-check.js
- **runArtistDiagnostics**: ç”»å¸ˆç”³è¯· â†’ ç©ºæ•°ç»„
- **runProductDiagnostics**: å•†å“æ•°æ® â†’ ç©ºæ•°ç»„

### 3. pages/buyer-show/publish/index.js
- **onLoad**: å•†å“ä¿¡æ¯ â†’ `cloudAPI.getProductList()`

### 4. pages/product-detail/index.js
- **loadProductDetail**: å•†å“æ•°æ® â†’ `cloudAPI.getProductList()`
- **ç”»å¸ˆä¿¡æ¯**: æ ‡è®°ä¸ºåºŸå¼ƒ

### 5. pages/search/index.js
- **loadProducts**: å•†å“åˆ—è¡¨ â†’ `cloudAPI.getProductList()`

### 6. pages/reward-records/index.js
- **loadRewards**: å·²å®Œæˆè®¢å• â†’ `cloudAPI.getOrderList({ status: 'completed' })`

---

## âš ï¸ å‰©ä½™æœ¬åœ°å­˜å‚¨è°ƒç”¨ï¼ˆ24å¤„ï¼‰

éœ€è¦é€ä¸€è¯„ä¼°æ˜¯å¦éœ€è¦æ¸…ç†ï¼Œæˆ–æ˜¯å¦å·²è¢«ä¸¥æ ¼äº‘ç«¯æ¨¡å¼æ‹¦æˆªã€‚

**ä½ç½®**ï¼šè¯¦è§ `/tmp/remaining_storage_calls.txt`

---

## ğŸ”’ æ‹¦æˆªæ•ˆæœ

**å¯åŠ¨å°ç¨‹åºåï¼Œä»»ä½•ç¦æ­¢çš„ç¼“å­˜è°ƒç”¨éƒ½ä¼šæŠ›å‡ºé”™è¯¯**ï¼š

```
âŒ ç¦æ­¢ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼špending_orders (operation: getStorageSync)
ğŸ“‹ è°ƒç”¨æ ˆ: Error: âŒ ç¦æ­¢ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼špending_orders...
    at throwStorageError (app.js:55)
    at wx.getStorageSync (app.js:69)
    at ...
ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼šè¯·ä½¿ç”¨ cloudAPI ä»äº‘ç«¯è·å–æ•°æ®
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **æµ‹è¯•éªŒè¯**ï¼š
   - å¯åŠ¨å°ç¨‹åº
   - è§¦å‘å„åŠŸèƒ½
   - è§‚å¯Ÿæ§åˆ¶å°æ˜¯å¦æœ‰æ‹¦æˆªé”™è¯¯

2. **ä¿®å¤å‰©ä½™è°ƒç”¨**ï¼š
   - åˆ†æå‰©ä½™24å¤„è°ƒç”¨
   - æ”¹ä¸ºäº‘ç«¯APIæˆ–æ ‡è®°ä¸ºåºŸå¼ƒ

3. **äº‘å‡½æ•°éƒ¨ç½²**ï¼š
   - ä¸Šä¼  serviceManager
   - ä¸Šä¼  userManager
   - æµ‹è¯•äº‘ç«¯æ•°æ®è¯»å†™

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**ï¼š2025-11-22  
**ä¸¥æ ¼äº‘ç«¯æ¨¡å¼ç‰ˆæœ¬**ï¼šv1.0
