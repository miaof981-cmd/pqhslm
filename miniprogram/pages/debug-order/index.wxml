<view class="debug-container">
  <view class="header">
    <text class="title">ğŸ” å…¨å±€è®¢å•è¯Šæ–­</text>
    <text class="subtitle">è‡ªåŠ¨æ‰«ææ‰€æœ‰è®¢å•é—®é¢˜ Â· æˆªå›¾å‘ç®¡ç†å‘˜</text>
  </view>

  <view wx:if="{{loading}}" class="loading">æ­£åœ¨æ‰«æ {{scanProgress}} ä¸ªè®¢å•...</view>

  <view wx:else class="result-list">
    <!-- é—®é¢˜æ±‡æ€» -->
    <view class="section summary-section {{(problemOrders.length > 0 || problemProducts.length > 0) ? 'has-error' : 'all-good'}}">
      <view class="summary-icon">{{(problemOrders.length > 0 || problemProducts.length > 0) ? 'âš ï¸' : 'âœ…'}}</view>
      <view class="summary-content">
        <text class="summary-title">{{(problemOrders.length > 0 || problemProducts.length > 0) ? 'å‘ç°æ•°æ®å¼‚å¸¸' : 'æ‰€æœ‰æ•°æ®æ­£å¸¸'}}</text>
        <text class="summary-count">è®¢å•é—®é¢˜: {{problemOrders.length}}ä¸ª / å•†å“é—®é¢˜: {{problemProducts.length}}ä¸ª</text>
      </view>
    </view>

    <!-- é—®é¢˜åˆ†ç±»ç»Ÿè®¡ -->
    <view wx:if="{{problemOrders.length > 0 || problemProducts.length > 0}}" class="section">
      <view class="section-title">ğŸ“Š é—®é¢˜åˆ†ç±»</view>
      <view class="item">
        <text class="label">âŒ å•†å“ä¸å­˜åœ¨ï¼š</text>
        <text class="value error">{{issueStats.productNotFound}}ä¸ª</text>
      </view>
      <view class="item">
        <text class="label">âš ï¸ ç”»å¸ˆIDä¸åŒ¹é…ï¼š</text>
        <text class="value warning">{{issueStats.artistMismatch}}ä¸ª</text>
      </view>
      <view class="item">
        <text class="label">âš ï¸ ç”»å¸ˆåå­—é”™è¯¯ï¼š</text>
        <text class="value warning">{{issueStats.wrongArtistName}}ä¸ª</text>
      </view>
      <view class="item">
        <text class="label">âš ï¸ åˆ†ç±»å¼‚å¸¸ï¼š</text>
        <text class="value warning">{{issueStats.wrongCategory}}ä¸ª</text>
      </view>
      <view class="item">
        <text class="label">âš ï¸ å®¢æœæœªåˆ†é…ï¼š</text>
        <text class="value warning">{{issueStats.noService}}ä¸ª</text>
      </view>
      <view class="item">
        <text class="label">âš ï¸ è®¢å•å­—æ®µç¼ºå¤±ï¼š</text>
        <text class="value warning">{{issueStats.missingFields}}ä¸ª</text>
      </view>
    </view>

    <!-- é—®é¢˜å•†å“åˆ—è¡¨ -->
    <view wx:if="{{problemProducts.length > 0}}" class="section">
      <view class="section-title">ğŸ›’ é—®é¢˜å•†å“æ˜ç»†</view>
      <view wx:for="{{problemProducts}}" wx:key="productId" class="problem-order-card">
        <view class="order-header">
          <text class="order-product">{{item.productName}}</text>
        </view>
        <view class="order-detail">
          <view wx:for="{{item.issues}}" wx:key="*this" wx:for-item="issue">
            <text wx:if="{{issue.type === 'artistName'}}" class="detail-line wrong-line">âŒ ç”»å¸ˆåå­—: {{issue.wrongValue}}</text>
            <text wx:if="{{issue.type === 'artistName'}}" class="detail-line correct-line">âœ… æ­£ç¡®åå­—: {{issue.correctValue}}</text>
            <text wx:if="{{issue.type === 'category'}}" class="detail-line wrong-line">âŒ åˆ†ç±»: {{issue.wrongValue}}</text>
            <text wx:if="{{issue.type === 'category'}}" class="detail-line correct-line">âœ… {{issue.correctValue}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- é—®é¢˜è®¢å•åˆ—è¡¨ -->
    <view wx:if="{{problemOrders.length > 0}}" class="section">
      <view class="section-title">ğŸš¨ é—®é¢˜è®¢å•æ˜ç»†ï¼ˆå‰10æ¡ï¼‰</view>
      <view wx:for="{{problemOrders}}" wx:key="orderId" class="problem-order-card">
        <view class="order-header">
          <text class="order-id">{{item.orderId}}</text>
          <text class="order-product">{{item.productName}}</text>
        </view>
        <view class="order-issues">
          <text wx:for="{{item.issues}}" wx:key="*this" wx:for-item="issue" class="issue-tag issue-{{issue.level}}">
            {{issue.text}}
          </text>
        </view>
        <view class="order-detail">
          <text class="detail-line">ä¹°å®¶ID: {{item.buyerId || 'ç¼ºå¤±'}}</text>
          <text class="detail-line">ç”»å¸ˆID: {{item.artistId || 'ç¼ºå¤±'}}</text>
          <text class="detail-line">å•†å“ID: {{item.productId || 'ç¼ºå¤±'}}</text>
        </view>
      </view>
    </view>

    <!-- æ•°æ®æºç»Ÿè®¡ -->
    <view class="section">
      <view class="section-title">ğŸ’¾ æ•°æ®æº</view>
      <view class="item">
        <text class="label">æ€»è®¢å•ï¼ˆå»é‡ï¼‰ï¼š</text>
        <text class="value success">{{totalOrders}}ä¸ª</text>
      </view>
      <view class="item">
        <text class="label">å•†å“æ€»æ•°ï¼š</text>
        <text class="value">{{totalProducts}}ä¸ª</text>
      </view>
      <view class="item">
        <text class="label">å®¢æœæ€»æ•°ï¼š</text>
        <text class="value {{totalServices > 0 ? 'success' : 'error'}}">{{totalServices}}ä¸ª</text>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="actions">
      <button class="btn" bindtap="copyResult">ğŸ“‹ å¤åˆ¶è¯Šæ–­æŠ¥å‘Š</button>
      <button class="btn secondary" bindtap="runDiagnosis">ğŸ”„ é‡æ–°æ‰«æ</button>
      <button wx:if="{{problemOrders.length > 0 || problemProducts.length > 0}}" class="btn fix-btn" bindtap="fixAllIssues">ğŸ”§ ä¸€é”®ä¿®å¤æ‰€æœ‰é—®é¢˜</button>
      <button class="btn secondary" bindtap="goBack">è¿”å›</button>
    </view>
  </view>
</view>

