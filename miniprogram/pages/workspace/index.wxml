<view class="workspace-container">
  <view wx:if="{{loading}}" class="loading">
    <text>加载中...</text>
  </view>

  <!-- 无权限提示 -->
  <view wx:elif="{{!hasPermission}}" class="no-permission">
    <view class="no-permission-icon">🔒</view>
    <view class="no-permission-title">暂无访问权限</view>
    <view class="no-permission-text">您还不是画师或客服</view>
    <view class="no-permission-hint">请先申请成为画师或联系管理员开通客服权限</view>
  </view>

  <view wx:else class="workspace-content">
    <!-- 顶部角色标题 -->
    <view class="header-bar">
      <text class="role-title" wx:if="{{userRole === 'artist'}}">画师工作台</text>
      <text class="role-title" wx:elif="{{userRole === 'service'}}">客服工作台</text>
    </view>

    <!-- ========== 核心区域：待处理订单 ========== -->
    <view class="pending-orders-section">
      <view class="section-title">待处理订单</view>
      
      <view class="pending-stats">
        <view class="stat-card normal" bindtap="goToOrders" data-type="progress">
          <view class="stat-number">{{pendingStats.inProgress || 0}}</view>
          <view class="stat-label">进行中</view>
        </view>
        
        <view class="stat-card warning" bindtap="goToOrders" data-type="nearDeadline">
          <view class="stat-number">{{pendingStats.nearDeadline || 0}}</view>
          <view class="stat-label">临近截稿</view>
        </view>
        
        <view class="stat-card danger" bindtap="goToOrders" data-type="overdue">
          <view class="stat-number">{{pendingStats.overdue || 0}}</view>
          <view class="stat-label">已拖稿</view>
        </view>
      </view>
      
      <!-- 快速订单管理入口 -->
      <button class="quick-btn-primary" bindtap="goToOrderManage">
        查看全部订单
      </button>
    </view>

    <!-- ========== 功能模块区 ========== -->
    <view class="functions-section">
      <view class="function-grid">
        <!-- 数据统计 -->
        <view class="function-item" bindtap="handleFunction" data-func="dataStats">
          <view class="func-icon stats-icon"></view>
          <text class="func-label">数据统计</text>
        </view>
        
        <!-- 商品管理 -->
        <view class="function-item" bindtap="handleFunction" data-func="productManage">
          <view class="func-icon product-icon"></view>
          <text class="func-label">商品管理</text>
        </view>
        
        <!-- 打赏记录 -->
        <view class="function-item" bindtap="handleFunction" data-func="rewards">
          <view class="func-icon reward-icon"></view>
          <text class="func-label">打赏记录</text>
        </view>
        
        <!-- 资金提现 -->
        <view class="function-item" bindtap="handleFunction" data-func="withdraw">
          <view class="func-icon money-icon"></view>
          <text class="func-label">资金提现</text>
        </view>
      </view>
    </view>

    <!-- ========== 平台须知（可折叠）========== -->
    <view class="notice-section">
      <view class="notice-header" bindtap="toggleNotices">
        <text class="notice-title">平台须知</text>
        <text class="toggle-icon">{{showNotices ? '▲' : '▼'}}</text>
      </view>
      
      <view wx:if="{{showNotices}}" class="notice-content">
        <view wx:for="{{notices}}" wx:key="id" class="notice-item">
          <text class="notice-dot">•</text>
          <text class="notice-text">{{item.content}}</text>
        </view>
      </view>
    </view>
  </view>
</view>
