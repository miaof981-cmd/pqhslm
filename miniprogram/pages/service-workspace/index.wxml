<view class="service-container">
  <!-- 精简顶栏：头像+信息+快捷操作 -->
  <view class="compact-header">
    <image class="header-avatar" src="{{serviceInfo.avatar}}" mode="aspectFill" />
    <view class="header-info">
      <text class="header-title">客服工作台</text>
      <text class="header-subtitle">编号{{serviceInfo.serviceNumber}} · {{serviceInfo.name}}</text>
    </view>
    <view class="header-actions">
      <view class="mini-action" bindtap="viewStats">统计</view>
      <view class="mini-action" bindtap="viewWithdraw">提现</view>
    </view>
  </view>

  <!-- 精简待办：单行显示 -->
  <view class="compact-stats">
    <view class="compact-stat" data-filter="pending" bindtap="filterOrders">
      <text class="stat-num">{{stats.pending}}</text>
      <text class="stat-text">待处理</text>
    </view>
    <view class="compact-stat" data-filter="processing" bindtap="filterOrders">
      <text class="stat-num">{{stats.processing}}</text>
      <text class="stat-text">进行中</text>
    </view>
    <view class="compact-stat" data-filter="urgent" bindtap="filterOrders">
      <text class="stat-num urgent">{{stats.urgent}}</text>
      <text class="stat-text">紧急</text>
    </view>
  </view>

  <!-- 订单筛选 -->
  <view class="filter-bar">
    <text class="filter-item {{currentFilter === 'all' ? 'active' : ''}}" 
          data-filter="all" 
          bindtap="switchFilter">全部</text>
    <text class="filter-item {{currentFilter === 'processing' ? 'active' : ''}}" 
          data-filter="processing" 
          bindtap="switchFilter">进行中</text>
    <text class="filter-item {{currentFilter === 'completed' ? 'active' : ''}}" 
          data-filter="completed" 
          bindtap="switchFilter">已完成</text>
  </view>

  <!-- 订单列表（紧凑布局） -->
  <view class="order-list">
    <view wx:if="{{filteredOrders.length === 0}}" class="empty-tip">
      暂无订单
    </view>
    
    <view wx:for="{{filteredOrders}}" wx:key="id" class="order-card-new">
      <!-- 订单头部 -->
      <view class="order-card-header" bindtap="viewOrderDetail" data-id="{{item.id}}">
        <view class="order-no-info">
          <text class="order-no-label">订单号</text>
          <text class="order-no-value">{{item.orderNumber || item.id}}</text>
        </view>
        <view class="order-status-badge status-{{item.status}}">
          <text class="status-text">{{item.statusText}}</text>
          <text wx:if="{{item.businessStatus}}" class="business-status">{{item.businessStatus}}</text>
        </view>
      </view>

      <!-- 订单内容 -->
      <view class="order-card-content" bindtap="viewOrderDetail" data-id="{{item.id}}">
        <image class="product-image-new" src="{{item.productImage}}" mode="aspectFill" />
        <view class="order-info-new">
          <text class="product-name-new">{{item.productName}}</text>
          <view class="order-meta-new">
            <text class="meta-text">买家：{{item.buyerName}}</text>
            <text class="meta-text">下单：{{item.createTime}}</text>
            <text wx:if="{{item.deadline}}" class="meta-text deadline {{item.isOverdue ? 'overdue' : ''}}">
              截稿：{{item.deadline}} {{item.isOverdue ? '⚠️已超时' : ''}}
            </text>
          </view>
        </view>
      </view>

      <!-- 订单操作区 -->
      <view class="order-card-actions">
        <text class="price-text">¥{{item.price}}</text>
        <view class="action-buttons">
          <button wx:if="{{item.status !== 'completed' && item.status !== 'refunded'}}" 
                  class="action-btn refund-btn" 
                  data-id="{{item.id}}" 
                  catchtap="initiateRefund">退款</button>
          <button class="action-btn detail-btn" 
                  data-id="{{item.id}}" 
                  catchtap="viewOrderDetail">详情</button>
        </view>
      </view>
    </view>
  </view>
</view>

