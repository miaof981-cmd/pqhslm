<view class="role-manage-container">
  <!-- 头部 -->
  <view class="header">
    <view class="back-btn" bindtap="goBack">
      <text class="back-icon">←</text>
    </view>
    <view class="header-title">权限管理</view>
    <view class="header-right"></view>
  </view>

  <!-- 用户信息 -->
  <view class="user-info-card">
    <view class="info-row">
      <view class="info-label">用户ID</view>
      <view class="info-value">{{userId}}</view>
    </view>
    <view class="info-hint">当前拥有 {{roles.length}} 个身份</view>
  </view>

  <!-- 快速切换用户视角 -->
  <view class="quick-switch-section">
    <view class="section-title">快速切换用户视角</view>
    <view class="user-scenarios">
      <view wx:for="{{userScenarios}}" wx:key="id"
            class="scenario-card {{currentScenario === item.id ? 'active' : ''}}"
            data-scenario="{{item.id}}"
            bindtap="switchScenario">
        <view class="scenario-icon">{{item.icon}}</view>
        <view class="scenario-name">{{item.name}}</view>
        <view class="scenario-roles">{{item.rolesText}}</view>
      </view>
    </view>
  </view>

  <!-- 安全警告 -->
  <view class="warning-card">
    <view class="warning-icon">⚠️</view>
    <view class="warning-content">
      <text class="warning-title">安全提示</text>
      <text class="warning-text">当前权限管理仅用于开发测试！生产环境必须使用云数据库存储权限，并在服务端验证。详见项目根目录的"权限管理说明.md"</text>
    </view>
  </view>

  <!-- 权限说明 -->
  <view class="tips-card">
    <view class="tips-icon">ℹ️</view>
    <view class="tips-content">
      <text class="tips-title">权限说明</text>
      <text class="tips-text">点击下方卡片可以添加或移除身份。拥有多个身份时，所有功能入口会同时显示在"我的"页面。</text>
    </view>
  </view>

  <!-- 角色列表 -->
  <view class="roles-section">
    <view class="section-title">可用身份</view>
    
    <view wx:for="{{availableRoles}}" wx:key="id" 
          class="role-card {{roles.indexOf(item.id) !== -1 ? 'active' : ''}}"
          data-role="{{item.id}}"
          bindtap="toggleRole">
      <view class="role-icon" style="background: {{item.color}};">
        <text>{{item.icon}}</text>
      </view>
      <view class="role-info">
        <view class="role-name">{{item.name}}</view>
        <view class="role-desc">{{item.desc}}</view>
      </view>
      <view class="role-status">
        <view class="status-indicator {{roles.indexOf(item.id) !== -1 ? 'active' : ''}}"></view>
      </view>
    </view>
  </view>

  <!-- 提示信息 -->
  <view class="bottom-tips">
    <text>💡 提示：这是开发测试功能，可快速切换不同用户视角进行测试</text>
  </view>
</view>

