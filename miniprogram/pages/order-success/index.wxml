<view class="order-success-container">
  <!-- 顶部成功状态 -->
  <view class="success-header">
    <view class="success-icon-wrapper">
      <view class="success-icon">✓</view>
    </view>
    <view class="success-title">订单创建成功！</view>
  </view>

  <!-- 客服引导区域（提前到最上方） -->
  <view class="service-guide-section">
    <view class="guide-title">
      <view class="title-icon">!</view>
      <text class="title-text">请立即添加客服微信</text>
    </view>
    
    <view class="guide-content">
      <text class="guide-text highlight">客服会与您进一步沟通绘画要求</text>
    </view>
  </view>

  <!-- 客服信息卡片（紧跟引导区域） -->
  <view class="service-info-card">
    <view class="service-header">
      <image class="service-avatar" src="{{serviceInfo && serviceInfo.serviceAvatar ? serviceInfo.serviceAvatar : '/assets/default-avatar.png'}}" mode="aspectFill" />
      <view class="service-details">
        <view class="service-name">{{serviceInfo && serviceInfo.serviceName ? serviceInfo.serviceName : '客服'}}</view>
        <view class="service-role">
          {{serviceInfo && serviceInfo.isPlaceholder ? '客服正在分配中，请耐心等待' : '您的专属客服'}}
        </view>
      </view>
    </view>
    
    <view class="qr-section">
      <view class="qr-wrapper">
        <view class="qr-label">
          <block wx:if="{{serviceInfo && serviceInfo.isPlaceholder}}">
            客服正在安排中，稍后将通过消息联系您
          </block>
          <block wx:else>
            长按识别添加 {{serviceInfo && serviceInfo.serviceName ? serviceInfo.serviceName : '客服'}}
          </block>
        </view>
        <block wx:if="{{serviceQR && serviceQR.imageUrl}}">
          <image class="qr-image" 
                 src="{{serviceQR.imageUrl}}" 
                 mode="aspectFit"
                 bindlongpress="onLongPressQR" />
          <view class="qr-hint">长按二维码 → 识别 → 添加好友</view>
        </block>
        <block wx:elif="{{serviceInfo && serviceInfo.isPlaceholder}}">
          <view class="qr-missing">暂无二维码，可直接回复下单时填写的联系方式，客服将尽快与您对接。</view>
        </block>
        <block wx:else>
          <view class="qr-missing">客服二维码暂未配置，请稍后联系</view>
        </block>
      </view>
    </view>
  </view>

  <!-- 订单信息卡片（折叠显示） -->
  <view class="order-info-card">
    <view class="card-title">订单详情</view>
    
    <view class="info-row">
      <text class="info-label">订单编号</text>
      <view class="info-value-wrapper">
        <text class="info-value">{{orderInfo.orderNo}}</text>
        <text class="copy-btn" bindtap="copyOrderNo">复制</text>
      </view>
    </view>

    <view wx:if="{{orderItems.length > 0}}" class="order-items">
      <view wx:for="{{orderItems}}" wx:key="index" class="order-item">
        <image class="order-item-cover" src="{{item.productImage}}" mode="aspectFill"></image>
        <view class="order-item-info">
          <view class="order-item-name">{{item.productName}}</view>
          <view wx:if="{{item.categoryName || (item.tags && item.tags.length)}}" class="order-item-tags">
            <text wx:if="{{item.categoryName}}" class="order-item-tag">{{item.categoryName}}</text>
            <text wx:for="{{item.tags}}" wx:key="*this" class="order-item-tag">{{item}}</text>
          </view>
          <view wx:if="{{item.specText}}" class="order-item-spec">{{item.specText}}</view>
          <view class="order-item-meta">
            <text class="order-item-qty">×{{item.quantity}}</text>
            <text class="order-item-price">¥{{item.totalPrice}}</text>
          </view>
        </view>
      </view>
    </view>
    
    <view class="info-row">
      <text class="info-label">数量</text>
      <text class="info-value">×{{orderInfo.quantity}}</text>
    </view>
    
    <view class="info-row total">
      <text class="info-label">订单金额</text>
      <text class="info-value amount">¥{{orderInfo.totalAmountDisplay || orderInfo.totalAmount}}</text>
    </view>
  </view>

  <!-- 温馨提示 -->
  <view class="warm-tips">
    <view class="tips-title">温馨提示</view>
    <view class="tips-list">
      <view class="tip-item">• 添加客服后请发送订单编号：{{orderInfo.orderNo}}</view>
      <view class="tip-item">• 客服工作时间：9:00 - 22:00</view>
      <view class="tip-item">• 请尽快联系客服完成支付，避免订单超时</view>
      <view class="tip-item">• 支付完成后客服将通知画师开始创作</view>
    </view>
  </view>

  <!-- 底部按钮 -->
  <view class="bottom-actions">
    <button class="action-btn secondary" bindtap="viewOrderDetail">查看订单</button>
    <button class="action-btn primary" bindtap="backToHome">返回首页</button>
  </view>
</view>
