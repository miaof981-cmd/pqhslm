<view class="container">
  <!-- хд┤щГицаЗщвШцаП -->
  <view class="header-section">
    <view class="header-content">
      <text class="page-title">ховцЬНчобчРЖ</text>
      <view class="add-btn" bindtap="showAddServiceModal">
        <text class="add-icon">+</text>
        <text class="add-text">ц╖╗хКаховцЬН</text>
      </view>
    </view>
  </view>

  <!-- ховцЬНхИЧшби -->
  <view class="service-list">
    <view wx:for="{{serviceList}}" wx:key="id" class="service-card">
      <!-- х╖жф╛зя╝Ъхд┤хГП -->
      <view class="card-left" bindtap="viewServiceDetail" data-id="{{item.id}}">
        <view class="service-avatar-wrap">
          <image class="service-avatar" src="{{item.avatar}}" mode="aspectFill" />
          <view class="service-number-badge">{{item.serviceNumber}}</view>
        </view>
      </view>

      <!-- ф╕нщЧ┤я╝ЪховцЬНф┐бцБп -->
      <view class="card-middle" bindtap="viewServiceDetail" data-id="{{item.id}}">
        <text class="service-name">{{item.name}}</text>
        <view class="service-meta">
          <text class="service-id">KF{{item.serviceNumber}}</text>
          <view class="status-badge {{item.isActive ? 'badge-online' : 'badge-offline'}}">
            <view class="status-dot"></view>
            <text class="status-text">{{item.isActive ? 'хЬич║┐' : 'чж╗ч║┐'}}</text>
          </view>
        </view>
      </view>

      <!-- хП│ф╛зя╝ЪцУНф╜ЬхМ║ -->
      <view class="card-right">
        <switch 
          class="status-switch" 
          checked="{{item.isActive}}" 
          bindchange="toggleServiceStatus" 
          data-id="{{item.id}}" 
          color="#66BB6A" />
        <view 
          class="edit-icon" 
          catchtap="viewServiceDetail" 
          data-id="{{item.id}}">
          <view class="menu-icon">
            <view class="menu-line"></view>
            <view class="menu-line"></view>
            <view class="menu-line"></view>
          </view>
        </view>
      </view>
    </view>

    <!-- чй║чК╢цАБ -->
    <view wx:if="{{serviceList.length === 0}}" class="empty-state">
      <view class="empty-icon"></view>
      <text class="empty-text">цЪВцЧаховцЬН</text>
      <text class="empty-hint">чВ╣хЗ╗хП│ф╕КшзТцМЙщТоц╖╗хКаховцЬН</text>
    </view>
  </view>

  <!-- ховцЬНшпжцГЕх╝╣чкЧ -->
  <view wx:if="{{showDetailModal}}" class="detail-modal-overlay" catchtap="hideDetailModal">
    <view class="detail-modal-content" catchtap="stopPropagation">
      <view class="detail-modal-header">
        <text class="detail-modal-title">ховцЬНшпжцГЕ</text>
        <view class="detail-modal-close" catchtap="hideDetailModal">├Ч</view>
      </view>
      
      <view class="detail-modal-body">
        <!-- ховцЬНхЯ║цЬмф┐бцБп -->
        <view class="detail-info-section">
          <view class="detail-avatar-wrap">
            <image class="detail-avatar" src="{{currentService.avatar}}" mode="aspectFill" />
            <view class="detail-number-badge">{{currentService.serviceNumber}}</view>
          </view>
          <view class="detail-info">
            <text class="detail-name">{{currentService.name}}</text>
            <text class="detail-id">ховцЬНч╝ЦхП╖я╝ЪKF{{currentService.serviceNumber}}</text>
            <text class="detail-wechat">х╛оф┐бхП╖я╝Ъ{{currentService.wechatId || 'цЬкшо╛ч╜о'}}</text>
            <view class="detail-status">
              <text class="detail-status-label">чК╢цАБя╝Ъ</text>
              <view class="status-badge {{currentService.isActive ? 'active' : 'inactive'}}">
                {{currentService.isActive ? 'хЬич║┐' : 'чж╗ч║┐'}}
              </view>
            </view>
          </view>
        </view>

        <!-- ф║Мч╗┤чаБхМ║хЯЯ -->
        <view class="detail-qrcode-section">
          <view class="detail-section-title">ховцЬНф║Мч╗┤чаБ</view>
          <view wx:if="{{currentService.qrcodeUrl}}" class="detail-qrcode-display">
            <image class="detail-qrcode-image" src="{{currentService.qrcodeUrl}}" mode="aspectFit" />
            <text class="detail-qrcode-label">ч╝ЦхП╖: {{currentService.qrcodeNumber}}</text>
            <button class="detail-action-btn secondary" catchtap="changeQrcode" data-id="{{currentService.id}}">
              цЫ┤цНвф║Мч╗┤чаБ
            </button>
          </view>
          <view wx:else class="detail-qrcode-empty">
            <text class="detail-empty-hint">цЪВцЬкч╗СхоЪховцЬНф║Мч╗┤чаБ</text>
            <button class="detail-action-btn primary" catchtap="bindQrcode" data-id="{{currentService.id}}">
              ф╕Кф╝аф║Мч╗┤чаБ
            </button>
          </view>
        </view>

        <!-- цУНф╜ЬцМЙщТо -->
        <view class="detail-actions">
          <button class="detail-action-btn primary" catchtap="showEditServiceModal" data-id="{{currentService.id}}">
            ч╝Цш╛СхЯ║цЬмф┐бцБп
          </button>
          <button class="detail-action-btn danger" catchtap="deleteService" data-id="{{currentService.id}}">
            чз╗щЩдховцЬН
          </button>
        </view>
      </view>
    </view>
  </view>

  <!-- ц╖╗хКаховцЬНх╝╣чкЧ -->
  <view wx:if="{{showAddModal}}" class="modal-overlay" catchtap="hideAddModal">
    <view class="modal-content add-service-modal" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">ц╖╗хКаховцЬН</text>
        <view class="modal-close" catchtap="hideAddModal">├Ч</view>
      </view>
      
      <view class="modal-body">
        <view class="form-item">
          <text class="form-label">чФицИ╖ID *</text>
          <input class="form-input" 
                 type="number" 
                 placeholder="шп╖ш╛УхЕечФицИ╖ID" 
                 value="{{newService.userId}}"
                 bindinput="onUserIdInput" />
          <text class="form-hint">ш╛УхЕечО░цЬЙчФицИ╖чЪДIDя╝Мх░ЖхЕ╢шо╛ч╜оф╕║ховцЬН</text>
        </view>

        <view class="form-item">
          <text class="form-label">ховцЬНхзУхРН *</text>
          <input class="form-input" 
                 placeholder="шп╖ш╛УхЕеховцЬНхзУхРН" 
                 value="{{newService.name}}"
                 bindinput="onNameInput" />
        </view>

        <view class="form-item">
          <text class="form-label">х╛оф┐бхП╖</text>
          <input class="form-input" 
                 placeholder="шп╖ш╛УхЕех╛оф┐бхП╖я╝ИщАЙхбля╝Й" 
                 value="{{newService.wechatId}}"
                 bindinput="onWechatIdInput" />
        </view>

        <view class="form-item">
          <text class="form-label">ховцЬНф║Мч╗┤чаБ</text>
          <view class="qrcode-upload">
            <view wx:if="{{newService.qrcodeUrl}}" class="qrcode-preview">
              <image class="preview-image" src="{{newService.qrcodeUrl}}" mode="aspectFit" />
              <view class="preview-remove" catchtap="removeQrcode">├Ч</view>
            </view>
            <button wx:else class="upload-btn" bindtap="uploadQrcode">
              <text class="upload-icon">+</text>
              <text class="upload-text">ф╕Кф╝аф║Мч╗┤чаБ</text>
            </button>
          </view>
          <text class="form-hint">ф╕Кф╝аховцЬНф╕кф║║х╛оф┐бф║Мч╗┤чаБ</text>
        </view>
      </view>

      <view class="modal-footer">
        <button class="modal-btn cancel-btn" catchtap="hideAddModal">хПЦц╢И</button>
        <button class="modal-btn confirm-btn" catchtap="confirmAddService">чбошодц╖╗хКа</button>
      </view>
    </view>
  </view>

  <!-- ч╝Цш╛СховцЬНх╝╣чкЧ -->
  <view wx:if="{{showEditModal}}" class="modal-overlay" catchtap="hideEditModal">
    <view class="modal-content add-service-modal" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">ч╝Цш╛СховцЬНф┐бцБп</text>
        <view class="modal-close" catchtap="hideEditModal">├Ч</view>
      </view>
      
      <view class="modal-body">
        <view class="form-item">
          <text class="form-label">чФицИ╖ID *</text>
          <input class="form-input" 
                 type="number" 
                 placeholder="шп╖ш╛УхЕечФицИ╖ID" 
                 value="{{editService.userId}}"
                 bindinput="onEditUserIdInput" />
          <text class="form-hint">ф┐оцФ╣чФицИ╖IDхРОф╝ЪшЗкхКицЫ┤цЦ░шпечФицИ╖чЪДхд┤хГП</text>
        </view>

        <view class="form-item">
          <text class="form-label">ховцЬНхзУхРН *</text>
          <input class="form-input" 
                 placeholder="шп╖ш╛УхЕеховцЬНхзУхРН" 
                 value="{{editService.name}}"
                 bindinput="onEditNameInput" />
        </view>

        <view class="form-item">
          <text class="form-label">х╛оф┐бхП╖</text>
          <input class="form-input" 
                 placeholder="шп╖ш╛УхЕех╛оф┐бхП╖я╝ИщАЙхбля╝Й" 
                 value="{{editService.wechatId}}"
                 bindinput="onEditWechatIdInput" />
        </view>

        <view class="form-hint" style="color: #FF9800; margin-top: 20rpx;">
          ЁЯТб цПРчд║я╝Ъф┐оцФ╣чФицИ╖IDхРОя╝Мч│╗ч╗Яф╝ЪшЗкхКишп╗хПЦшпечФицИ╖чЪДхд┤хГПф┐бцБп
        </view>
      </view>

      <view class="modal-footer">
        <button class="modal-btn cancel-btn" catchtap="hideEditModal">хПЦц╢И</button>
        <button class="modal-btn confirm-btn" catchtap="confirmEditService">ф┐ЭхнШф┐оцФ╣</button>
      </view>
    </view>
  </view>
</view>
