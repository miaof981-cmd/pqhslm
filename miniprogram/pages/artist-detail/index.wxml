<view class="container">
  <view wx:if="{{loading}}" class="loading">
    <text>加载中...</text>
  </view>

  <view wx:else>
    <!-- 画师头部信息 -->
    <view class="artist-header">
      <image class="artist-avatar" src="{{artist.avatar}}" mode="aspectFill" />
      <view class="artist-info">
        <view class="artist-name-row">
          <text class="artist-name">{{artist.name}}</text>
          <view class="artist-level level-{{artist.level}}">{{artist.level}}级画师</view>
        </view>
        <text class="artist-intro">{{artist.intro}}</text>
        <view class="artist-stats">
          <view class="stat-item">
            <text class="stat-value">{{artist.productCount}}</text>
            <text class="stat-label">作品</text>
          </view>
          <view class="stat-item">
            <text class="stat-value">{{artist.orderCount}}</text>
            <text class="stat-label">订单</text>
          </view>
          <view class="stat-item">
            <text class="stat-value">{{artist.rating}}</text>
            <text class="stat-label">评分</text>
          </view>
          <view class="stat-item">
            <text class="stat-value">{{artist.fans}}</text>
            <text class="stat-label">粉丝</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 操作按钮 -->
    <view class="action-bar">
      <button class="action-btn follow-btn {{artist.isFollowed ? 'followed' : ''}}" bindtap="toggleFollow">
        {{artist.isFollowed ? '已关注' : '+ 关注'}}
      </button>
      <button class="action-btn contact-btn" bindtap="contactArtist">联系画师</button>
    </view>

    <!-- Tab切换 -->
    <view class="tab-bar">
      <view wx:for="{{tabs}}" wx:key="value"
            class="tab-item {{currentTab === item.value ? 'active' : ''}}"
            data-tab="{{item.value}}"
            bindtap="switchTab">
        <text class="tab-text">{{item.label}}</text>
      </view>
    </view>

    <!-- 作品列表 -->
    <view wx:if="{{currentTab === 'products'}}" class="products-section">
      <view wx:if="{{products.length > 0}}" class="product-grid">
        <view wx:for="{{products}}" wx:key="_id" class="product-item" bindtap="viewProduct" data-id="{{item._id}}">
          <image class="product-image" src="{{item.image}}" mode="aspectFill" />
          <view class="product-info">
            <text class="product-name">{{item.name}}</text>
            <view class="product-footer">
              <text class="product-price">¥{{item.price}}</text>
              <text class="product-sales">已售{{item.sales}}</text>
            </view>
          </view>
        </view>
      </view>
      <view wx:else class="empty-state">
        <text class="empty-text">暂无作品</text>
      </view>
    </view>

    <!-- 业绩数据 -->
    <view wx:elif="{{currentTab === 'performance'}}" class="performance-section">
      <view class="performance-card">
        <view class="card-title">本月业绩</view>
        <view class="performance-stats">
          <view class="perf-item">
            <text class="perf-label">订单数</text>
            <text class="perf-value">{{performance.monthOrders}}</text>
          </view>
          <view class="perf-item">
            <text class="perf-label">成交额</text>
            <text class="perf-value">¥{{performance.monthRevenue}}</text>
          </view>
          <view class="perf-item">
            <text class="perf-label">完成率</text>
            <text class="perf-value">{{performance.completeRate}}%</text>
          </view>
        </view>
      </view>

      <view class="performance-card">
        <view class="card-title">累计业绩</view>
        <view class="performance-stats">
          <view class="perf-item">
            <text class="perf-label">总订单</text>
            <text class="perf-value">{{performance.totalOrders}}</text>
          </view>
          <view class="perf-item">
            <text class="perf-label">总收入</text>
            <text class="perf-value">¥{{performance.totalRevenue}}</text>
          </view>
          <view class="perf-item">
            <text class="perf-label">好评率</text>
            <text class="perf-value">{{performance.goodRate}}%</text>
          </view>
        </view>
      </view>

      <view class="performance-card">
        <view class="card-title">月度趋势</view>
        <view class="chart-placeholder">
          <text class="chart-text">图表区域（待集成）</text>
        </view>
      </view>
    </view>

    <!-- 评价列表 -->
    <view wx:elif="{{currentTab === 'reviews'}}" class="reviews-section">
      <view wx:if="{{reviews.length > 0}}" class="review-list">
        <view wx:for="{{reviews}}" wx:key="_id" class="review-item">
          <view class="review-header">
            <image class="reviewer-avatar" src="{{item.userAvatar}}" mode="aspectFill" />
            <view class="reviewer-info">
              <text class="reviewer-name">{{item.userName}}</text>
              <view class="review-rating">
                <view wx:for="{{[1,2,3,4,5]}}" wx:for-item="star" wx:key="*this" class="star {{star <= item.rating ? 'filled' : ''}}"></view>
              </view>
            </view>
            <text class="review-time">{{item.createTime}}</text>
          </view>
          <text class="review-content">{{item.content}}</text>
          <view wx:if="{{item.images.length > 0}}" class="review-images">
            <image wx:for="{{item.images}}" wx:for-item="img" wx:key="*this" 
                   class="review-image" 
                   src="{{img}}" 
                   mode="aspectFill"
                   bindtap="previewImage"
                   data-url="{{img}}"
                   data-urls="{{item.images}}" />
          </view>
        </view>
      </view>
      <view wx:else class="empty-state">
        <text class="empty-text">暂无评价</text>
      </view>
    </view>
  </view>
</view>
