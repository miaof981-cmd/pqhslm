<view class="service-dashboard">
  <view wx:if="{{loading}}" class="loading">
    <text>加载中...</text>
  </view>

  <view wx:else class="dashboard-content">
    <!-- 今日待办 -->
    <view class="todo-section">
      <view class="section-header">
        <text class="header-icon">📊</text>
        <text class="header-title">今日待办</text>
      </view>
      
      <view class="todo-cards">
        <view class="todo-card urgent">
          <view class="todo-number">{{todoStats.pendingOrders}}</view>
          <view class="todo-label">待处理订单</view>
        </view>
        <view class="todo-card warning">
          <view class="todo-number">{{todoStats.pendingMessages}}</view>
          <view class="todo-label">待回复咨询</view>
        </view>
        <view class="todo-card danger">
          <view class="todo-number">{{todoStats.delayedOrders}}</view>
          <view class="todo-label">延期订单</view>
        </view>
      </view>
    </view>

    <!-- 快捷统计 -->
    <view class="quick-stats">
      <view class="stat-item">
        <text class="stat-label">今日订单</text>
        <text class="stat-value">{{quickStats.todayOrders}}</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-label">今日收入</text>
        <text class="stat-value">¥{{quickStats.todayRevenue}}</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-label">总订单</text>
        <text class="stat-value">{{quickStats.totalOrders}}</text>
      </view>
    </view>

    <!-- 订单列表 -->
    <view class="orders-section">
      <view class="section-header">
        <text class="header-icon">📋</text>
        <text class="header-title">订单列表</text>
      </view>
      
      <!-- 订单标签 -->
      <view class="order-tabs">
        <view class="tab-item {{currentTab === 'pending' ? 'active' : ''}}" 
              data-tab="pending" 
              bindtap="switchTab">
          待处理
        </view>
        <view class="tab-item {{currentTab === 'processing' ? 'active' : ''}}" 
              data-tab="processing" 
              bindtap="switchTab">
          进行中
        </view>
        <view class="tab-item {{currentTab === 'completed' ? 'active' : ''}}" 
              data-tab="completed" 
              bindtap="switchTab">
          已完成
        </view>
      </view>
      
      <!-- 订单卡片列表 -->
      <view wx:if="{{orders.length > 0}}" class="order-list">
        <view wx:for="{{orders}}" wx:key="_id" class="order-card">
          <!-- 订单头部 -->
          <view class="order-header">
            <text class="order-no">{{item.orderNo}}</text>
            <view class="order-status {{item.status}}">{{item.statusText}}</view>
          </view>
          
          <!-- 订单信息 -->
          <view class="order-body">
            <view class="order-info-row">
              <text class="info-label">商品：</text>
              <text class="info-value">{{item.productName}}</text>
            </view>
            <view class="order-info-row">
              <text class="info-label">规格：</text>
              <text class="info-value">{{item.spec}}</text>
            </view>
            <view class="order-info-row">
              <text class="info-label">客户：</text>
              <text class="info-value">{{item.customerName}}</text>
            </view>
            <view class="order-info-row">
              <text class="info-label">画师：</text>
              <text class="info-value">{{item.artistName}}</text>
            </view>
            <view class="order-info-row">
              <text class="info-label">下单：</text>
              <text class="info-value">{{item.createTime}}</text>
            </view>
            <view class="order-info-row">
              <text class="info-label">截止：</text>
              <text class="info-value highlight">{{item.deadline}}</text>
            </view>
            <view class="order-info-row">
              <text class="info-label">金额：</text>
              <text class="info-value price">¥{{item.amount}}</text>
            </view>
          </view>
          
          <!-- 订单操作 -->
          <view class="order-actions">
            <button class="action-btn primary" 
                    data-id="{{item._id}}" 
                    bindtap="viewOrderDetail">
              查看详情
            </button>
            <button class="action-btn secondary" 
                    data-id="{{item._id}}" 
                    bindtap="contactCustomer">
              联系客户
            </button>
            <button class="action-btn secondary" 
                    data-id="{{item._id}}" 
                    bindtap="contactArtist">
              联系画师
            </button>
          </view>
        </view>
      </view>
      
      <!-- 空状态 -->
      <view wx:else class="empty-state">
        <text class="empty-icon">📭</text>
        <text class="empty-text">暂无订单</text>
      </view>
    </view>

    <!-- 快捷功能 -->
    <view class="quick-actions">
      <view class="section-header">
        <text class="header-icon">🔧</text>
        <text class="header-title">快捷功能</text>
      </view>
      
      <view class="action-grid">
        <view class="action-item" bindtap="viewAllOrders">
          <view class="action-icon">📋</view>
          <text class="action-label">查看所有订单</text>
        </view>
        <view class="action-item" bindtap="viewMessages">
          <view class="action-icon">💬</view>
          <text class="action-label">客户咨询记录</text>
        </view>
        <view class="action-item" bindtap="viewProfile">
          <view class="action-icon">👤</view>
          <text class="action-label">我的资料</text>
        </view>
      </view>
    </view>
  </view>
</view>

