<view class="container">
  <view wx:if="{{loading}}" class="loading">
    <text>加载中...</text>
  </view>
  
  <view wx:else>
    <!-- 用户信息卡片 -->
    <view class="user-card">
      <view class="user-main-info">
        <image class="user-avatar" src="{{userInfo.avatar}}" mode="aspectFill" />
        <view class="user-details">
          <view class="user-name">{{userInfo.name}}</view>
          <view class="user-id">ID: {{userId}}</view>
          <view class="user-roles">
            <text wx:for="{{roleTexts}}" wx:key="*this" class="role-tag">{{item}}</text>
          </view>
        </view>
      </view>
      <view class="role-manage-btn" bindtap="goToRoleManage">权限</view>
    </view>

    <!-- 我的订单 -->
    <view class="order-section">
      <view class="section-header">
        <text class="section-title">我的约稿</text>
        <text class="view-all" bindtap="viewAllOrders">查看全部 ></text>
      </view>
      
      <view class="order-stats">
        <view class="stat-item" data-status="created" bindtap="viewAllOrders">
          <view class="stat-icon processing"></view>
          <text class="stat-label">进行中</text>
          <text class="stat-count">{{orderStats.created}}</text>
        </view>
        <view class="stat-item" data-status="completed" bindtap="viewAllOrders">
          <view class="stat-icon completed"></view>
          <text class="stat-label">已完成</text>
          <text class="stat-count">{{orderStats.completed}}</text>
        </view>
        <view class="stat-item" data-status="refunded" bindtap="viewAllOrders">
          <view class="stat-icon refunded"></view>
          <text class="stat-label">已退款</text>
          <text class="stat-count">{{orderStats.refunded}}</text>
        </view>
        <view class="stat-item" bindtap="viewAllOrders">
          <view class="stat-icon all"></view>
          <text class="stat-label">全部订单</text>
          <text class="stat-count">{{orderStats.total}}</text>
        </view>
      </view>
    </view>

    <!-- 工作台入口（根据角色显示） -->
    <view class="workspace-section">
      <!-- 画师认证 -->
      <view wx:if="{{roles.indexOf('artist') === -1 && roles.indexOf('admin') === -1}}" class="workspace-card cert-card" bindtap="applyArtist">
        <view class="workspace-icon cert-icon"></view>
        <view class="workspace-info">
          <text class="workspace-title">画师认证</text>
          <text class="workspace-desc">点此进入画师认证开始工作吧！</text>
        </view>
        <view class="workspace-arrow">></view>
      </view>

      <!-- 画师工作台 -->
      <view wx:if="{{roles.indexOf('artist') !== -1 || roles.indexOf('admin') !== -1}}" class="workspace-card artist-card" bindtap="goToArtistDashboard">
        <view class="workspace-icon artist-icon"></view>
        <view class="workspace-info">
          <text class="workspace-title">画师工作台</text>
          <text class="workspace-desc">管理作品、订单和会员</text>
          <view wx:if="{{memberInfo}}" class="member-badge {{memberInfo.isValid ? 'active' : 'expired'}}">
            {{memberInfo.isValid ? '会员有效' : '会员已过期'}}
          </view>
        </view>
        <view class="workspace-arrow">></view>
      </view>

      <!-- 管理后台 -->
      <view wx:if="{{roles.indexOf('admin') !== -1}}" class="workspace-card admin-card" bindtap="goToAdmin">
        <view class="workspace-icon admin-icon"></view>
        <view class="workspace-info">
          <text class="workspace-title">管理后台</text>
          <text class="workspace-desc">平台管理和数据统计</text>
        </view>
        <view class="workspace-arrow">></view>
      </view>
    </view>

    <!-- 其他功能 -->
    <view class="other-section">
      <text class="section-title">其他</text>
      
      <view class="function-grid">
        <view class="function-item">
          <view class="function-icon icon-favorite"></view>
          <text class="function-label">收藏和关注</text>
        </view>
        <view class="function-item">
          <view class="function-icon icon-history"></view>
          <text class="function-label">历史足迹</text>
        </view>
        <view class="function-item">
          <view class="function-icon icon-service"></view>
          <text class="function-label">平台售后</text>
        </view>
        <view class="function-item">
          <view class="function-icon icon-show"></view>
          <text class="function-label">我的买家秀</text>
        </view>
        <view class="function-item">
          <view class="function-icon icon-reward"></view>
          <text class="function-label">打赏记录</text>
        </view>
      </view>
    </view>

    <!-- 版权信息 -->
    <view class="copyright">
      <text class="copyright-text">画师商城版权所有©2024</text>
      <text class="copyright-text">让创意更有价值</text>
    </view>
  </view>
</view>