<view class="income-detail-container">
  <view wx:if="{{loading}}" class="loading">åŠ è½½ä¸­...</view>

  <view wx:else>
    <!-- ğŸ¯ ä½™é¢å¡ç‰‡ -->
    <view class="balance-card">
      <view class="balance-main">
        <text class="balance-label">å¯æç°ä½™é¢</text>
        <text class="balance-amount">Â¥{{availableBalance}}</text>
      </view>
      <view class="balance-actions">
        <view class="balance-info-item">
          <text class="info-label">å†å²æ€»æ”¶å…¥</text>
          <text class="info-value">Â¥{{totalIncome}}</text>
        </view>
        <view class="balance-divider"></view>
        <view class="balance-action-btn" bindtap="showWithdrawRecordsModal">
          <text class="action-label">æç°è®°å½•</text>
          <text class="action-arrow">â€º</text>
        </view>
      </view>
    </view>

    <!-- ğŸ¯ è´¦å•æµæ°´ -->
    <view class="transaction-list">
      <view class="list-header">
        <text class="header-title">è´¦å•æµæ°´</text>
        <text class="header-count">å…± {{records.length}} ç¬”</text>
      </view>

      <view wx:if="{{records.length === 0}}" class="empty-state">
        <view class="empty-icon">ğŸ“‹</view>
        <text class="empty-text">æš‚æ— è´¦å•è®°å½•</text>
        <text class="empty-hint">æ”¶å…¥å’Œæç°è®°å½•ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ</text>
      </view>

      <view wx:else class="transaction-items">
        <view 
          wx:for="{{records}}" 
          wx:key="id" 
          class="transaction-item type-{{item.subType}}"
        >
          <view class="item-badge {{item.subType}}">
            <text>{{item.typeText}}</text>
          </view>
          <view class="item-content">
            <text class="item-title">{{item.title}}</text>
            <text class="item-time">{{item.time}}</text>
          </view>
          <view class="item-right">
            <text class="item-amount {{item.isIncome ? 'income' : 'outcome'}}">{{item.amountText}}</text>
            <text class="item-balance">ä½™é¢ Â¥{{item.balanceText}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>

<!-- ğŸ¯ æç°è®°å½•å¼¹çª— -->
<view wx:if="{{showWithdrawRecordsModal}}" class="withdraw-modal-mask" bindtap="closeWithdrawRecordsModal">
  <view class="withdraw-modal-content" catchtap="stopPropagation">
    <view class="withdraw-modal-header">
      <text class="withdraw-modal-title">æç°è®°å½•</text>
      <text class="withdraw-modal-close" bindtap="closeWithdrawRecordsModal">Ã—</text>
    </view>
    
    <view class="withdraw-modal-body">
      <view wx:if="{{withdrawRecords.length === 0}}" class="withdraw-empty">
        <text class="withdraw-empty-icon">ğŸ“</text>
        <text class="withdraw-empty-text">æš‚æ— æç°è®°å½•</text>
      </view>
      
      <view wx:else class="withdraw-list">
        <view wx:for="{{withdrawRecords}}" wx:key="id" class="withdraw-item status-{{item.status}}">
          <view class="withdraw-item-header">
            <text class="withdraw-item-amount">-Â¥{{item.amount}}</text>
            <view class="withdraw-item-status">{{item.statusText}}</view>
          </view>
          <view class="withdraw-item-info">
            <text class="withdraw-info-line">æç°é“¶è¡Œï¼š{{item.bankName || 'æœªçŸ¥é“¶è¡Œ'}}(****{{item.bankCard || '0000'}})</text>
            <text class="withdraw-info-line">æç°æ—¶é—´ï¼š{{item.time}}</text>
            <text wx:if="{{item.completedTime}}" class="withdraw-info-line">å®Œæˆæ—¶é—´ï¼š{{item.completedTime}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
