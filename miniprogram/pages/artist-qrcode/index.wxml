<view class="container">
  <view class="header-section">
    <view class="header-icon">📋</view>
    <view class="header-title">建立画师档案</view>
    <view class="header-subtitle">完善个人信息，开启接单之旅</view>
  </view>

  <!-- 进度指示 -->
  <view class="progress-section">
    <view class="progress-item {{step >= 1 ? 'active' : ''}} {{step > 1 ? 'completed' : ''}}">
      <view class="progress-dot">1</view>
      <text class="progress-text">个人信息</text>
    </view>
    <view class="progress-line {{step > 1 ? 'active' : ''}}"></view>
    <view class="progress-item {{step >= 2 ? 'active' : ''}}">
      <view class="progress-dot">2</view>
      <text class="progress-text">工作信息</text>
    </view>
  </view>

  <view class="content-section">
    <!-- ========== 步骤1：个人信息登记 ========== -->
    <view wx:if="{{step === 1}}" class="step-content">
      <view class="form-section">
        <text class="section-title">联系方式</text>
        <text class="section-hint">用于内部联系，不会公开在主页</text>

        <!-- 联系手机号 -->
        <view class="form-item">
          <text class="form-label required">联系手机号</text>
          <view class="phone-input-group">
            <input 
              class="form-input phone-input" 
              type="number" 
              maxlength="11"
              placeholder="请输入手机号" 
              value="{{contactPhone}}"
              bindinput="onPhoneInput"
            />
            <button 
              class="verify-btn {{canSendCode ? '' : 'disabled'}}" 
              bindtap="sendVerifyCode"
              disabled="{{!canSendCode}}"
            >
              {{codeButtonText}}
            </button>
          </view>
        </view>

        <!-- 验证码 -->
        <view class="form-item">
          <text class="form-label required">验证码</text>
          <input 
            class="form-input" 
            type="number" 
            maxlength="6"
            placeholder="请输入验证码" 
            value="{{verifyCode}}"
            bindinput="onCodeInput"
          />
        </view>

        <!-- 联系微信 -->
        <view class="form-item">
          <text class="form-label required">联系微信</text>
          <input 
            class="form-input" 
            placeholder="请输入微信号" 
            value="{{contactWechat}}"
            bindinput="onWechatInput"
          />
        </view>

        <!-- 紧急联系人 -->
        <view class="form-item">
          <text class="form-label required">紧急联系人</text>
          <input 
            class="form-input" 
            placeholder="请输入紧急联系人姓名" 
            value="{{emergencyName}}"
            bindinput="onEmergencyNameInput"
          />
        </view>

        <!-- 紧急联系电话 -->
        <view class="form-item">
          <text class="form-label required">紧急联系电话</text>
          <input 
            class="form-input" 
            type="number" 
            maxlength="11"
            placeholder="请输入紧急联系人电话" 
            value="{{emergencyPhone}}"
            bindinput="onEmergencyPhoneInput"
          />
        </view>
      </view>

      <!-- 下一步按钮 -->
      <view class="step-actions">
        <button class="action-btn primary" bindtap="goToStep2">
          下一步
        </button>
      </view>
    </view>

    <!-- ========== 步骤2：工作信息设置 ========== -->
    <view wx:if="{{step === 2}}" class="step-content">
      <!-- 工作二维码 -->
      <view class="form-section">
        <text class="section-title">工作二维码</text>
        <text class="section-hint">客户下单后会看到此二维码，用于联系您</text>

        <view wx:if="{{qrcodeUrl}}" class="qrcode-preview">
          <image class="qrcode-image" src="{{qrcodeUrl}}" mode="aspectFit" />
          <button class="change-btn" bindtap="chooseQRCode">更换二维码</button>
        </view>

        <view wx:else class="qrcode-upload" bindtap="chooseQRCode">
          <view class="upload-icon">📸</view>
          <text class="upload-hint">点击上传工作二维码</text>
          <text class="upload-desc">建议上传清晰的二维码图片</text>
        </view>
      </view>

      <!-- 接单昵称 -->
      <view class="form-section">
        <view class="form-item">
          <text class="form-label required">接单昵称</text>
          <input 
            class="form-input" 
            placeholder="请输入接单昵称（2-20字）" 
            maxlength="20"
            value="{{artistName}}"
            bindinput="onArtistNameInput"
          />
        </view>

        <!-- 接单简介 -->
        <view class="form-item">
          <text class="form-label required">接单简介</text>
          <textarea 
            class="form-textarea" 
            placeholder="请简单介绍您的绘画风格、擅长类型等（10-200字）" 
            maxlength="200"
            value="{{artistBio}}"
            bindinput="onArtistBioInput"
          />
          <text class="char-count">{{artistBio.length}}/200</text>
        </view>
      </view>

      <!-- 提交按钮 -->
      <view class="step-actions">
        <button class="action-btn secondary" bindtap="backToStep1">
          上一步
        </button>
        <button class="action-btn primary" bindtap="submitProfile">
          提交档案
        </button>
      </view>
    </view>

    <!-- ========== 完成状态 ========== -->
    <view wx:if="{{step === 3}}" class="success-content">
      <view class="success-icon">✓</view>
      <text class="success-title">个人档案已建立</text>
      <text class="success-desc">您现在可以开始接单了</text>
      
      <view class="success-info">
        <view class="info-item">
          <text class="info-label">接单昵称</text>
          <text class="info-value">{{artistName}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">联系手机</text>
          <text class="info-value">{{contactPhone}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">档案建立时间</text>
          <text class="info-value">{{createTime}}</text>
        </view>
      </view>

      <button class="action-btn primary" bindtap="goToWorkspace">
        进入工作台
      </button>
    </view>

    <!-- 重要说明 -->
    <view wx:if="{{step < 3}}" class="notice-box">
      <view class="notice-title">重要说明</view>
      <view class="notice-item">
        <text class="notice-dot">•</text>
        <text class="notice-text">联系方式仅用于内部联系，不会公开在主页</text>
      </view>
      <view class="notice-item">
        <text class="notice-dot">•</text>
        <text class="notice-text">档案建立后，您可以新增最新联系方式</text>
      </view>
      <view class="notice-item">
        <text class="notice-dot">•</text>
        <text class="notice-text">历史联系方式将被永久保留，无法删除</text>
      </view>
      <view class="notice-item">
        <text class="notice-dot">•</text>
        <text class="notice-text">请确保信息真实有效，便于平台联系</text>
      </view>
    </view>
  </view>
</view>
