# é—®é¢˜å®šä½æŠ¥å‘Šv2 - äº‘ç«¯è¿ç§»å…¨å±€æ‰«æ

> **ç”Ÿæˆæ—¶é—´**ï¼š2025-11-22  
> **æ‰«æèŒƒå›´**ï¼šminiprogram å…¨ç›®å½•  
> **æ£€æµ‹ç»´åº¦**ï¼š8ä¸ªï¼ˆæœ¬åœ°ç¼“å­˜è¯»å†™ã€æ—§APIå¼•ç”¨ã€æœªè¿ç§»é¡µé¢ã€å­—æ®µä¸ä¸€è‡´ã€Mockæ®‹ç•™ã€é™çº§é€»è¾‘ã€å¼‚æ­¥é”™è¯¯ã€Promiseé“¾ï¼‰

---

## ğŸ“Š é—®é¢˜ç»Ÿè®¡æ€»è§ˆ

| é—®é¢˜ç±»å‹ | æ–‡ä»¶æ•° | é—®é¢˜ç‚¹æ•° | ä¸¥é‡åº¦ |
|---------|-------|---------|--------|
| 1. æœ¬åœ°ç¼“å­˜è¯»å– | 32 | 515+ | ğŸ”´ P0 |
| 2. æœ¬åœ°ç¼“å­˜å†™å…¥ | 28 | 200+ | ğŸ”´ P0 |
| 3. æ—§APIå¼•ç”¨ | 0 | 0 | âœ… æ—  |
| 4. æœªè¿ç§»cloudAPI | 28+ | 28+ | ğŸŸ  P1 |
| 5. å­—æ®µåä¸ä¸€è‡´ | 21 | 124+ | ğŸŸ¡ P2 |
| 6. useMockDataæ®‹ç•™ | 2 | 14 | ğŸ”´ P0 |
| 7. æœ¬åœ°é™çº§é€»è¾‘ | 1 | 10+ | ğŸŸ  P1 |
| 8. å¼‚æ­¥awaitç¼ºå¤± | 4 | 5 | ğŸŸ¡ P2 |

**æ€»è®¡ï¼š42ä¸ªæ–‡ä»¶ï¼Œ880+å¤„é—®é¢˜ç‚¹**

---

## ğŸ”´ P0 - ä¸¥é‡é—®é¢˜ï¼ˆç«‹å³ä¿®å¤ï¼‰

### 1. config/env.js - Mockæ¨¡å¼æœªå…³é—­

**ä½ç½®ï¼š** `miniprogram/config/env.js`

```javascript
// ç¬¬6è¡Œ
useMockData: true,           // âŒ ä»ä¸ºå¼€å‘æ¨¡å¼

// ç¬¬23è¡Œ
const currentEnv = 'dev'     // âŒ ä»ä¸ºå¼€å‘ç¯å¢ƒ
```

**å½±å“ï¼š**
- æ‰€æœ‰ `utils/api.js` çš„äº‘æ•°æ®åº“è°ƒç”¨è¢«è·³è¿‡
- `order-success/index.js:865` è®¢å•åˆ›å»ºè¢«è·³è¿‡
- å…¨å±€è¿›å…¥é™çº§æ¨¡å¼ï¼Œæ‰€æœ‰å†™å…¥åªå­˜æœ¬åœ°

**ä¿®å¤ï¼š**
```javascript
useMockData: false
const currentEnv = 'prod'
```

---

### 2. æœ¬åœ°ç¼“å­˜è¯»å– - 515+å¤„

#### 2.1 è®¢å•æ•°æ®ï¼ˆ17ä¸ªæ–‡ä»¶ï¼Œ76å¤„ï¼‰

**æ ¸å¿ƒé—®é¢˜æ–‡ä»¶ï¼š**

| æ–‡ä»¶ | è¯»å–ç‚¹ | é—®é¢˜ä»£ç  |
|-----|-------|---------|
| `order-list/index.js` | 389-391è¡Œ | `wx.getStorageSync('orders')` `wx.getStorageSync('pending_orders')` |
| `order-detail/index.js` | 54-55è¡Œ | `wx.getStorageSync('pending_orders')` `wx.getStorageSync('completed_orders')` |
| `admin/index.js` | 1517-1625è¡Œ | 4ä¸ªè®¢å•æºæ··ç”¨ï¼šorders/pending/completed/mock |
| `workspace/index.js` | 810è¡Œ | `wx.getStorageSync('pending_orders')` |
| `service-workspace/index.js` | 456-457è¡Œ | `wx.getStorageSync('pending_orders')` |
| `user-center/index.js` | 659-660è¡Œ | `wx.getStorageSync('pending_orders')` |
| `income-detail/index.js` | 38-39è¡Œ | `wx.getStorageSync('pending_orders')` |
| `report/index.js` | 112-113è¡Œ | `wx.getStorageSync('pending_orders')` |
| `withdraw/index.js` | 49-50è¡Œ | `wx.getStorageSync('pending_orders')` |
| `reward-records/index.js` | 112,386-387è¡Œ | 3å¤„è®¢å•è¯»å– |
| `order-success/index.js` | 646,789,977è¡Œ | ä¸‹å•é¡µä»è¯»æœ¬åœ°è®¢å• |
| `debug-order/index.js` | 330-331è¡Œ | è¯Šæ–­å·¥å…·è¯»æœ¬åœ° |
| `order-diagnosis/index.js` | 45è¡Œ | è¯Šæ–­é¡µè¯»æœ¬åœ° |
| `app.js` | 306,316è¡Œ | å…¨å±€è®¢å•åˆå§‹åŒ–è¯»æœ¬åœ° |
| `utils/order-helper.js` | 390-391è¡Œ | å·¥å…·å‡½æ•°è¯»æœ¬åœ° |
| `utils/order-diagnosis.js` | 142è¡Œ | è¯Šæ–­å·¥å…·è¯»æœ¬åœ° |
| `utils/user-helper.js` | 221,273è¡Œ | ç”¨æˆ·å·¥å…·è¯»æœ¬åœ°è®¢å• |

**åº”æ›¿æ¢ä¸ºï¼š**
```javascript
// âŒ é”™è¯¯
const orders = wx.getStorageSync('pending_orders') || []

// âœ… æ­£ç¡®
const res = await cloudAPI.getOrderList({ status: 'pending' })
const orders = res.success ? res.data.list : []
```

#### 2.2 å®¢æœæ•°æ®ï¼ˆ13ä¸ªæ–‡ä»¶ï¼Œ44å¤„ï¼‰

| æ–‡ä»¶ | è¯»å–ç‚¹ | é—®é¢˜ä»£ç  |
|-----|-------|---------|
| `order-success/index.js` | 343,350è¡Œ | `wx.getStorageSync('customer_service_list')` |
| `service-qr-manage/index.js` | 34,196,288,339,369,390,423,526,560è¡Œ | 9å¤„å®¢æœåˆ—è¡¨è¯»å– |
| `reward-records/index.js` | 150è¡Œ | `wx.getStorageSync('service_list')` |
| `admin/index.js` | 1489è¡Œ | `wx.getStorageSync('service_list')` |
| `report/index.js` | 247è¡Œ | `wx.getStorageSync('customer_service_list')` |
| `order-detail/index.js` | 622è¡Œ | `wx.getStorageSync('service_list')` |
| `service-workspace/index.js` | 76è¡Œ | `wx.getStorageSync('service_list')` |
| `product-detail/index.js` | 321,323è¡Œ | 2å¤„å®¢æœåˆ—è¡¨è¯»å– |
| `debug-order/index.js` | 33-34è¡Œ | åŒé‡é™çº§è¯»å– |
| `utils/order-helper.js` | 88,437,482è¡Œ | 3å¤„å·¥å…·å‡½æ•°è¯»æœ¬åœ° |
| `utils/order-status.js` | 220è¡Œ | `wx.getStorageSync('customer_service_list')` |
| `utils/qrcode-helper.js` | 18,20è¡Œ | 2å¤„äºŒç»´ç è¾…åŠ©å‡½æ•°è¯»æœ¬åœ° |
| `utils/system-check.js` | 32,34è¡Œ | ç³»ç»Ÿæ£€æŸ¥è¯»æœ¬åœ° |

**åº”æ›¿æ¢ä¸ºï¼š**
```javascript
// âŒ é”™è¯¯
const services = wx.getStorageSync('service_list') || []

// âœ… æ­£ç¡®
const res = await cloudAPI.getServiceList()
const services = res.success ? res.data : []
```

#### 2.3 å…¶ä»–æœ¬åœ°æ•°æ®ï¼ˆå¤šä¸ªæ–‡ä»¶ï¼‰

**å•†å“æ•°æ®ï¼š**
- `order-success/index.js:25` - `wx.getStorageSync('mock_products')`
- `admin/index.js:323,694,878,1374,1410` - 5å¤„å•†å“åˆ—è¡¨è¯»å–
- `reward-records/index.js:144` - `wx.getStorageSync('mock_products')`

**ç”¨æˆ·æ•°æ®ï¼š**
- `admin/index.js:326,776` - `wx.getStorageSync('mock_users')`
- `order-success/index.js:531` - `wx.getStorageSync('mock_users')`

**ç”»å¸ˆç”³è¯·ï¼š**
- `order-success/index.js:491` - `wx.getStorageSync('artist_applications')`
- `admin/index.js:175,690,929,1812` - 4å¤„ç”»å¸ˆç”³è¯·è¯»å–
- `workspace/index.js:189` - `wx.getStorageSync('artist_applications')`
- `reward-records/index.js:157` - `wx.getStorageSync('artist_applications')`
- `apply/index.js:342` - `wx.getStorageSync('artist_applications')`

**å…¶ä»–é…ç½®ï¼š**
- `category-manage/index.js:61` - `wx.getStorageSync('product_categories')`
- `login/index.js:35,36` - `wx.getStorageSync('userInfo')` `wx.getStorageSync('hasLoggedIn')`
- `order-list/index.js:33,36` - äºŒç»´ç é…ç½®è¯»å–
- `buyer-show/index/index.js:20` - `wx.getStorageSync('buyer_show_posts')`

---

### 3. æœ¬åœ°ç¼“å­˜å†™å…¥ - 200+å¤„

#### 3.1 è®¢å•å†™å…¥ï¼ˆ12ä¸ªæ–‡ä»¶ï¼Œ44å¤„ï¼‰

| æ–‡ä»¶ | å†™å…¥ç‚¹ | é—®é¢˜ä»£ç  |
|-----|-------|---------|
| `order-success/index.js` | 776,999è¡Œ | `wx.setStorageSync('pending_orders', orders)` |
| `order-list/index.js` | 476-477,571è¡Œ | 3å¤„è®¢å•å†™å…¥ |
| `order-detail/index.js` | 307,422,429,570è¡Œ | 4å¤„è®¢å•å†™å…¥ |
| `admin/index.js` | 1528,1539,1673-1676,2091-2094è¡Œ | 11å¤„è®¢å•å†™å…¥ï¼ˆåŒ…æ‹¬æ¸…ç©ºï¼‰ |
| `workspace/index.js` | 804,814è¡Œ | 2å¤„è®¢å•å†™å…¥ |
| `service-workspace/index.js` | 514-515è¡Œ | `wx.setStorageSync('pending_orders')` |
| `app.js` | 308,318è¡Œ | å…¨å±€è®¢å•åŒæ­¥å†™å…¥ |
| `utils/api.js` | 100,169-170è¡Œ | æœ¬åœ°APIå†™è®¢å• |
| `utils/user-helper.js` | 245,312è¡Œ | ç”¨æˆ·è¾…åŠ©å‡½æ•°å†™è®¢å• |
| `debug-order/index.js` | 362-363è¡Œ | è¯Šæ–­å·¥å…·å†™è®¢å• |

#### 3.2 å®¢æœæ•°æ®å†™å…¥ï¼ˆ5ä¸ªæ–‡ä»¶ï¼Œ22å¤„ï¼‰

| æ–‡ä»¶ | å†™å…¥ç‚¹ | é—®é¢˜ä»£ç  |
|-----|-------|---------|
| `service-qr-manage/index.js` | 240,243,300-301,345-346,474-475,531-532,566-567è¡Œ | 13å¤„å®¢æœæ•°æ®å†™å…¥ |
| `order-success/index.js` | 353,375-376,421-422è¡Œ | 6å¤„å®¢æœåˆ—è¡¨åŒæ­¥å†™å…¥ |

#### 3.3 å…¶ä»–æ•°æ®å†™å…¥

**ç”¨æˆ·ç™»å½•ï¼š**
- `login/index.js:113-116,120,211` - 6å¤„ç”¨æˆ·ä¿¡æ¯å†™å…¥

**å•†å“/åˆ†ç±»ï¼š**
- `admin/index.js:1379,1412,2097` - å•†å“æ•°æ®å†™å…¥
- `apply/index.js:344` - ç”»å¸ˆç”³è¯·å†™å…¥
- `admin/index.js:1822,1829,1838,1905` - ç”»å¸ˆç”³è¯·å†™å…¥

**å…¶ä»–ï¼š**
- `order-list/index.js:34,37` - äºŒç»´ç é…ç½®å†™å…¥
- `workspace/index.js:435,654` - å·¥ä½œå°é…ç½®å†™å…¥
- `reward-records/index.js:403` - æ‰“èµè®°å½•å†™å…¥
- `admin/index.js:2100,2103` - è´­ç‰©è½¦å’Œç‰ˆæœ¬å·å†™å…¥

---

## ğŸŸ  P1 - é«˜ä¼˜å…ˆçº§é—®é¢˜

### 4. æœªè¿ç§» cloudAPI çš„é¡µé¢ï¼ˆ28ä¸ªï¼‰

**å·²å¼•å…¥ cloudAPI ä½†æœªå®Œå…¨ä½¿ç”¨ï¼ˆ12ä¸ªï¼‰ï¼š**

| é¡µé¢ | å·²æœ‰cloudAPIè°ƒç”¨ | ç¼ºå¤±è°ƒç”¨ |
|-----|-----------------|---------|
| `admin/index.js` | âœ… getOrderList | âŒ updateOrderStatus, getProducts, getUsers |
| `workspace/index.js` | âœ… getOrderList | âŒ updateOrderStatus, getApplications |
| `order-list/index.js` | âœ… getOrderList | âŒ updateOrderStatus, cancelOrder |
| `order-success/index.js` | âœ… createOrder | âŒ getServices, getProducts |
| `service-qr-manage/index.js` | âœ… getServiceList, addService, updateService | âŒ å®Œæ•´è¿ç§»ï¼ˆä»å†™æœ¬åœ°ï¼‰ |
| `category-manage/index.js` | âœ… å®Œæ•´è¿ç§» | âœ… å·²å®Œæˆï¼ˆç¤ºèŒƒé¡µé¢ï¼‰ |
| `login/index.js` | âœ… login | âŒ ä»å†™æœ¬åœ°storage |
| `reward-records/index.js` | âœ… getRewardList | âŒ ä»è¯»æœ¬åœ°è®¢å•/å•†å“ |
| `apply/index.js` | âœ… getApplicationStatus | âŒ ä»å†™æœ¬åœ°ç”³è¯·æ•°æ® |
| `product-manage/index.js` | âœ… getProductList | âŒ æœªè¯»å®Œæ•´è°ƒç”¨ |
| `home/index.js` | âœ… getBannerList, getProductList, getNoticeList | âŒ ä»è¯»æœ¬åœ°åˆ†ç±» |
| `banner-manage/index.js` | âœ… getBannerList, createBanner, deleteBanner | âœ… åŸºæœ¬å®Œæˆ |

**å®Œå…¨æœªå¼•å…¥ cloudAPIï¼ˆ16ä¸ªï¼‰ï¼š**

1. `order-detail/index.js` - âŒ ä»ç”¨æœ¬åœ°è®¢å•è¯»å†™
2. `service-workspace/index.js` - âŒ ä»ç”¨æœ¬åœ°è®¢å•è¯»å†™
3. `user-center/index.js` - âŒ ä»è¯»æœ¬åœ°è®¢å•
4. `income-detail/index.js` - âŒ ä»è¯»æœ¬åœ°è®¢å•
5. `report/index.js` - âŒ ä»è¯»æœ¬åœ°è®¢å•/å®¢æœ
6. `withdraw/index.js` - âŒ ä»è¯»æœ¬åœ°è®¢å•
7. `product-detail/index.js` - âŒ ä»è¯»æœ¬åœ°å®¢æœ
8. `artist-dashboard/index.js` - âŒ å®Œå…¨æœªå¼•å…¥
9. `artist-detail/index.js` - âŒ å®Œå…¨æœªå¼•å…¥
10. `debug-order/index.js` - âŒ è¯Šæ–­å·¥å…·ä»è¯»æœ¬åœ°
11. `order-diagnosis/index.js` - âŒ è¯Šæ–­é¡µä»è¯»æœ¬åœ°
12. `buyer-show/publish/index.js` - âŒ å®Œå…¨æœªå¼•å…¥
13. `service-dashboard/index.js` - âŒ å®Œå…¨æœªå¼•å…¥
14. `user-manage/index.js` - âŒ å®Œå…¨æœªå¼•å…¥
15. `product-edit/index.js` - âŒ å®Œå…¨æœªå¼•å…¥ï¼ˆæ¨æµ‹ï¼‰
16. `artist-products-manage/index.js` - âŒ å®Œå…¨æœªå¼•å…¥ï¼ˆæ¨æµ‹ï¼‰

---

### 5. utils/api.js - æœ¬åœ°é™çº§é€»è¾‘ï¼ˆ10+å¤„ï¼‰

**ä½ç½®ï¼š** `miniprogram/utils/api.js`

**é—®é¢˜ç‚¹ï¼š**
- ç¬¬36è¡Œï¼š`getUserInfo` - Mocké™çº§
- ç¬¬54è¡Œï¼š`saveUserInfo` - Mocké™çº§
- ç¬¬97è¡Œï¼š`createOrder` - Mocké™çº§ï¼ˆå†™æœ¬åœ°ï¼‰
- ç¬¬116è¡Œï¼š`getOrderList` - Mocké™çº§ï¼ˆè¯»æœ¬åœ°ï¼‰
- ç¬¬155è¡Œï¼š`updateOrderStatus` - Mocké™çº§ï¼ˆå†™æœ¬åœ°ï¼‰
- ç¬¬198è¡Œï¼š`getProductInfo` - Mocké™çº§
- ç¬¬228è¡Œï¼š`getProductList` - Mocké™çº§
- ç¬¬269è¡Œï¼š`addIncome` - Mocké™çº§
- ç¬¬288è¡Œï¼š`getIncomeList` - Mocké™çº§

**å½±å“ï¼š**
è™½ç„¶ pages ç›®å½•æ— ç›´æ¥å¼•ç”¨ï¼Œä½†å¯èƒ½è¢« utils å·¥å…·å‡½æ•°é—´æ¥è°ƒç”¨

**å»ºè®®ï¼š**
1. é‡å‘½åä¸º `api-deprecated.js`
2. æ·»åŠ åºŸå¼ƒè­¦å‘Šæ—¥å¿—
3. é€æ­¥è¿ç§»æ‰€æœ‰é—´æ¥è°ƒç”¨
4. æœ€ç»ˆåˆ é™¤æ–‡ä»¶

---

## ğŸŸ¡ P2 - ä¸­ä¼˜å…ˆçº§é—®é¢˜

### 6. å­—æ®µåä¸ä¸€è‡´ï¼ˆ21ä¸ªæ–‡ä»¶ï¼Œ124+å¤„ï¼‰

**ä¸»è¦é—®é¢˜ï¼š**

#### 6.1 orderId vs id

**æœç´¢ç»“æœï¼š** 21ä¸ªæ–‡ä»¶ä¸­å‡ºç° `orderId` æˆ–ç›¸å…³å­—æ®µ

**å¯èƒ½ä¸ä¸€è‡´çš„ä½ç½®ï¼š**
- å‰ç«¯ä½¿ç”¨ `orderId`ï¼Œäº‘å‡½æ•°å†™å…¥ `id`
- éœ€é€ä¸ªæ–‡ä»¶æ£€æŸ¥å­—æ®µä¸€è‡´æ€§

**å»ºè®®æ£€æŸ¥æ–‡ä»¶ï¼š**
- `order-detail/index.js` - 19å¤„ orderId
- `service-workspace/index.js` - 16å¤„ orderId
- `admin/index.js` - 18å¤„ orderId
- `workspace/index.js` - 1å¤„ orderId
- `order-list/index.js` - 14å¤„ orderId
- ç­‰ç­‰...

#### 6.2 openid vs _openid

**äº‘æ•°æ®åº“å­—æ®µï¼š** `_openid`ï¼ˆå¾®ä¿¡è‡ªåŠ¨ç”Ÿæˆï¼‰  
**å‰ç«¯å¯èƒ½è¯¯ç”¨ï¼š** `openid`ï¼ˆè‡ªå®šä¹‰å­—æ®µï¼‰

**éœ€æ£€æŸ¥ï¼š**
- `login/index.js:115` - `wx.setStorageSync('openid', userData.openid)`
- `apply/index.js:313` - `const openid = wx.getStorageSync('openid')`
- äº‘å‡½æ•° `orderManager/index.js:68` - æ­£ç¡®ä½¿ç”¨ `_openid`

---

### 7. å¼‚æ­¥ await ç¼ºå¤±ï¼ˆ4ä¸ªæ–‡ä»¶ï¼Œ5å¤„ï¼‰

**ä½¿ç”¨ .then() é“¾çš„æ–‡ä»¶ï¼š**

| æ–‡ä»¶ | è¡Œæ•° | é£é™© |
|-----|-----|------|
| `workspace/index.js` | 1å¤„ | å¯èƒ½æœªç­‰å¾…äº‘å‡½æ•°è¿”å› |
| `home/index.js` | 1å¤„ | å¯èƒ½æœªç­‰å¾…äº‘å‡½æ•°è¿”å› |
| `withdraw/index.js` | 2å¤„ | å¯èƒ½æœªç­‰å¾…äº‘å‡½æ•°è¿”å› |
| `service-dashboard/index.js` | 1å¤„ | å¯èƒ½æœªç­‰å¾…äº‘å‡½æ•°è¿”å› |

**å»ºè®®ï¼š**
ç»Ÿä¸€æ”¹ä¸º async/await æ¨¡å¼ï¼Œä¾¿äºé”™è¯¯æ•è·

---

## ğŸ“‹ ä¿®å¤ä¼˜å…ˆçº§å»ºè®®

### é˜¶æ®µä¸€ï¼šåˆ‡æ¢ç”Ÿäº§æ¨¡å¼ï¼ˆ1å¤©ï¼‰

1. **config/env.js** - `currentEnv = 'prod'`ï¼Œ`useMockData = false`
2. **éªŒè¯äº‘å‡½æ•°** - ç¡®ä¿7ä¸ªäº‘å‡½æ•°å·²éƒ¨ç½²
3. **æµ‹è¯• cloudAPI** - ç¡®ä¿ cloud-api.js èƒ½æ­£å¸¸è°ƒç”¨

### é˜¶æ®µäºŒï¼šè¿ç§»æ ¸å¿ƒæ•°æ®æµï¼ˆ3-5å¤©ï¼‰

**ä¼˜å…ˆçº§æ’åºï¼š**

1. **è®¢å•åˆ›å»ºæµç¨‹** - `order-success/index.js`
   - ç§»é™¤æœ¬åœ° pending_orders å†™å…¥
   - ä¾èµ–äº‘å‡½æ•° createOrder
   
2. **è®¢å•åˆ—è¡¨é¡µ** - `order-list/index.js`ã€`order-detail/index.js`
   - æ›¿æ¢æ‰€æœ‰ getStorageSync â†’ cloudAPI.getOrderList
   
3. **ç®¡ç†åå°** - `admin/index.js`
   - æ›¿æ¢4ä¸ªè®¢å•æºï¼ˆorders/pending/completed/mockï¼‰
   - ç»Ÿä¸€è°ƒç”¨ cloudAPI
   
4. **å·¥ä½œå°** - `workspace/index.js`ã€`service-workspace/index.js`
   - æ›¿æ¢æœ¬åœ°è®¢å•è¯»å–
   - æ·»åŠ  cloudAPI è°ƒç”¨

5. **å®¢æœæ•°æ®** - æ‰€æœ‰13ä¸ªæ–‡ä»¶
   - ç»Ÿä¸€ä» cloudAPI.getServiceList è¯»å–
   - ç§»é™¤æ‰€æœ‰æœ¬åœ°å†™å…¥

### é˜¶æ®µä¸‰ï¼šè¿ç§»æ¬¡è¦é¡µé¢ï¼ˆ2-3å¤©ï¼‰

6. **ç»Ÿè®¡æŠ¥è¡¨** - `report/index.js`ã€`income-detail/index.js`ã€`withdraw/index.js`
7. **ç”¨æˆ·ä¸­å¿ƒ** - `user-center/index.js`ã€`artist-dashboard/index.js`
8. **ä¹°å®¶ç§€** - `buyer-show/*`
9. **è¯Šæ–­å·¥å…·** - `debug-order/index.js`ã€`order-diagnosis/index.js`

### é˜¶æ®µå››ï¼šæ¸…ç†é—ç•™ä»£ç ï¼ˆ1å¤©ï¼‰

10. **åºŸå¼ƒ utils/api.js**
11. **ç§»é™¤æ‰€æœ‰ setStorageSync**
12. **æ¸…ç©ºæœ¬åœ°æµ‹è¯•æ•°æ®**

---

## ğŸ” å¿«é€Ÿå®šä½å‘½ä»¤

```bash
# æ£€æŸ¥è®¢å•æœ¬åœ°è¯»å–
grep -rn "getStorageSync('pending_orders\|orders\|completed_orders')" miniprogram/pages --include="*.js"

# æ£€æŸ¥å®¢æœæœ¬åœ°è¯»å–
grep -rn "getStorageSync('service_list\|customer_service_list')" miniprogram --include="*.js"

# æ£€æŸ¥ Mock æ¨¡å¼
grep -rn "useMockData\|emergencyFallback" miniprogram --include="*.js"

# æ£€æŸ¥ cloudAPI ä½¿ç”¨
grep -rn "cloudAPI\." miniprogram/pages --include="*.js"

# æ£€æŸ¥å­—æ®µå
grep -rn "orderId\|_openid" miniprogram/pages --include="*.js" | wc -l
```

---

## âš ï¸ é£é™©æç¤º

1. **æ•°æ®ä¸ä¸€è‡´é£é™©** - è¿ç§»æœŸé—´å¯èƒ½å‡ºç°äº‘ç«¯ä¸æœ¬åœ°æ•°æ®ä¸åŒæ­¥
2. **ç”¨æˆ·ä½“éªŒé£é™©** - äº‘å‡½æ•°è°ƒç”¨å¤±è´¥æ— é™çº§æ–¹æ¡ˆï¼Œå¯èƒ½å¯¼è‡´ç™½å±
3. **æµ‹è¯•è¦†ç›–ä¸è¶³** - éœ€å……åˆ†æµ‹è¯•æ‰€æœ‰æ•°æ®æµå‘
4. **å›æ»šæ–¹æ¡ˆ** - ä¿ç•™æœ¬åœ°é™çº§é€»è¾‘ï¼Œç”Ÿäº§ç¯å¢ƒå‡ºé—®é¢˜å¯å¿«é€Ÿå›æ»š

---

## âœ… ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³ä¿®å¤ P0** - config/env.js æ”¹ä¸ºç”Ÿäº§æ¨¡å¼
2. **åˆ›å»ºæ—¥å¿—ç³»ç»Ÿ** - åœ¨æ‰€æœ‰ cloudAPI è°ƒç”¨å‰åæ’å…¥æ—¥å¿—
3. **åˆ›å»ºé”™è¯¯æ•è·** - å…¨å±€é”™è¯¯å¤„ç†æ¨¡å—
4. **åˆ†æ‰¹è¿ç§»** - æŒ‰ç…§é˜¶æ®µäºŒçš„ä¼˜å…ˆçº§é€æ­¥è¿ç§»

---

**æŠ¥å‘Šç”Ÿæˆå®Œæ¯•ï¼Œå»ºè®®ä¼˜å…ˆå¤„ç† P0 é—®é¢˜ã€‚**

