# è®¢å•ç»Ÿè®¡å·®å¼‚è¯Šæ–­å·¥å…·

## é—®é¢˜ç°è±¡
ç®¡ç†åå°æ˜¾ç¤º6ä¸ªå¾…å¤„ç†è®¢å•ï¼Œä½†ç”¨æˆ·/ç”»å¸ˆç«¯åªæ˜¾ç¤º5ä¸ªåˆ¶ä½œä¸­ã€‚

## è¯Šæ–­æ­¥éª¤

### æ–¹æ³•1ï¼šæŸ¥çœ‹ç®¡ç†åå°æ—¥å¿—ï¼ˆæœ€ç®€å•ï¼‰

1. æ‰“å¼€å°ç¨‹åº
2. åˆ‡æ¢åˆ°ç®¡ç†åå°
3. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…· â†’ æ§åˆ¶å°
4. æŸ¥çœ‹æ—¥å¿—è¾“å‡ºï¼Œä¼šçœ‹åˆ°ï¼š

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š å¾…å¤„ç†è®¢å•è¯¦ç»†åˆ†å¸ƒ:
  å¾…æ”¯ä»˜: Xä¸ª
  å·²æ”¯ä»˜: Xä¸ª
  åˆ¶ä½œä¸­: Xä¸ª
  å¾…ç¡®è®¤: Xä¸ª
  ä¸´è¿‘æˆªç¨¿: Xä¸ª
  æ€»è®¡: 6ä¸ª
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

**é‡ç‚¹å…³æ³¨ï¼šå“ªä¸ªçŠ¶æ€çš„è®¢å•æ•°é‡å’Œç”¨æˆ·ç«¯ä¸ä¸€è‡´**

---

### æ–¹æ³•2ï¼šè¿è¡Œè¯Šæ–­å·¥å…·ï¼ˆè¯¦ç»†ï¼‰

1. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. åœ¨æ§åˆ¶å°è¾“å…¥ï¼š

```javascript
const orderDiagnosis = require('./utils/order-diagnosis.js')

// å¿«é€Ÿè¯Šæ–­
orderDiagnosis.quickDiagnose()

// æ£€æŸ¥é‡å¤è®¢å•
orderDiagnosis.checkDuplicates()

// å®Œæ•´è¯Šæ–­æŠ¥å‘Š
orderDiagnosis.diagnoseOrderCounts()
```

3. æŸ¥çœ‹è¾“å‡ºçš„å·®å¼‚è®¢å•ä¿¡æ¯

---

## å¯èƒ½çš„åŸå› 

### 1. æ•°æ®æºé‡å¤
è®¢å•åŒæ—¶å­˜åœ¨äº `orders`ã€`pending_orders`ã€`mock_orders` å¤šä¸ªå­˜å‚¨ä¸­ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
```javascript
// åœ¨æ§åˆ¶å°è¿è¡Œ
orderDiagnosis.checkDuplicates()
```

å¦‚æœå‘ç°é‡å¤ï¼Œå¯ä»¥æ¸…ç†ï¼š
```javascript
// ä¿ç•™ pending_ordersï¼Œæ¸…ç©ºå…¶ä»–
wx.removeStorageSync('orders')
wx.removeStorageSync('mock_orders')
```

### 2. æ—§æµ‹è¯•æ•°æ®é—ç•™
ä¹‹å‰æµ‹è¯•æ—¶åˆ›å»ºçš„è®¢å•æ²¡æœ‰æ¸…ç†ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
- åœ¨ç®¡ç†åå°è®¢å•åˆ—è¡¨ä¸­æ‰¾åˆ°å¤šä½™çš„è®¢å•
- æ‰‹åŠ¨åˆ é™¤æˆ–æ ‡è®°ä¸ºå–æ¶ˆ/å®Œæˆ

### 3. è®¢å•çŠ¶æ€å¼‚å¸¸
è®¢å•çŠ¶æ€ä¸åœ¨é¢„æœŸèŒƒå›´å†…ï¼ˆå¦‚ç©ºçŠ¶æ€ã€é”™è¯¯çŠ¶æ€ï¼‰ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
```javascript
// æŸ¥çœ‹æ‰€æœ‰è®¢å•çŠ¶æ€
const orderHelper = require('./utils/order-helper.js')
const allOrders = orderHelper.getAllOrders()
allOrders.forEach(o => {
  console.log(`è®¢å•${o.id}: ${o.status}`)
})
```

### 4. ç”¨æˆ·ç«¯ç­›é€‰é—æ¼
ç”¨æˆ·ç«¯çš„ `prepareOrdersForPage` ç­›é€‰æ¡ä»¶æœ‰é—®é¢˜ï¼Œé—æ¼äº†æŸäº›è®¢å•ã€‚

**æ£€æŸ¥æ–¹æ³•ï¼š**
```javascript
const userId = wx.getStorageSync('userId')

// æ£€æŸ¥ç”»å¸ˆç«¯è®¢å•
const artistOrders = orderHelper.prepareOrdersForPage({
  role: 'artist',
  userId: userId
})
console.log('ç”»å¸ˆç«¯è®¢å•:', artistOrders.length)

// æ£€æŸ¥ä¹°å®¶ç«¯è®¢å•
const customerOrders = orderHelper.prepareOrdersForPage({
  role: 'customer', 
  userId: userId
})
console.log('ä¹°å®¶ç«¯è®¢å•:', customerOrders.length)
```

---

## ä¸´æ—¶è§£å†³æ–¹æ¡ˆ

å¦‚æœè¯Šæ–­åä»æ— æ³•æ‰¾åˆ°æ ¹å› ï¼Œå¯ä»¥ä¸´æ—¶ï¼š

1. **æ¸…ç©ºæ‰€æœ‰è®¢å•æ•°æ®ï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰ï¼š**
```javascript
wx.removeStorageSync('orders')
wx.removeStorageSync('pending_orders')
wx.removeStorageSync('mock_orders')
wx.removeStorageSync('completed_orders')
```

2. **é‡æ–°ä¸‹å•æµ‹è¯•ï¼š**
- ä»¥ä¸åŒè§’è‰²ä¸‹å•
- è§‚å¯Ÿè®¢å•ç»Ÿè®¡æ˜¯å¦ä¸€è‡´

---

## æŠ¥å‘Šæ ¼å¼

è¯·å°†è¯Šæ–­ç»“æœåé¦ˆï¼ŒåŒ…æ‹¬ï¼š
1. å·®å¼‚è®¢å•çš„ID
2. å·®å¼‚è®¢å•çš„çŠ¶æ€
3. å·®å¼‚è®¢å•çš„ç”»å¸ˆIDå’Œä¹°å®¶ID
4. æ˜¯å¦æœ‰é‡å¤è®¢å•

ç¤ºä¾‹ï¼š
```
å·®å¼‚è®¢å•ID: 1732887312345
çŠ¶æ€: unpaidï¼ˆä½†è¿™ä¸åº”è¯¥å‡ºç°ï¼‰
ç”»å¸ˆID: 1001
ä¹°å®¶ID: 1002
é‡å¤æƒ…å†µ: åŒæ—¶å‡ºç°åœ¨ orders å’Œ pending_orders
```

